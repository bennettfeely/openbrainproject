settings={autosave:!1,brain_model_path:"Brain_06/Brain_006.gltf",head_model_path:"Head_02/Head_02.gltf",orbit:!1,orbit_speed:4,grid_size:10,square_grid:!1,polar_grid:!1,axes:!0,pan:!1,zoom:{enabled:!0,min:15,max:30},slice:{visible:!1,axis:"y",position:0,size:.25,dimensions:{x:7,y:12,z:7}},brain:{roughness:.1,metalness:.3,wireframe:!1,color:{default:"salmon",hover:"firebrick",active:"darkred",focus:"#fdfa00"},offset:{x:-1.8,y:0,z:0}},head:{visible:!0,roughness:1,metalness:0,wireframe:!0,color:{default:"#333"},offset:{x:-1.8,y:0,z:0}}},regions_obj={R_Frontal_Pole_0:{path:"right-frontal-pole",wiki_path:"frontal_lobe",full_name:"Right Frontal Pole"},R_Insular_Cortex_1:{path:"right-insular-cortex",wiki_path:"insular_cortex",full_name:"Right Insular Cortex"},R_Middle_Frontal_Gyrus_3:{path:"right-middle-frontal-gyrus",wiki_path:"frontal_gyrus",full_name:"Right Middle Frontal Gyrus"},R_Inferior_Frontal_Gyrus__pars_opercularis_5:{path:"right-inferior-frontal-gyrus-(pars-opercularis)",wiki_path:"frontal_gyrus",full_name:"Right Inferior Frontal Gyrus (pars opercularis)"},R_Inferior_Frontal_Gyrus__pars_triangularis_4:{path:"right-inferior-frontal-gyrus-(pars-triangularis)",wiki_path:"frontal_gyrus",full_name:"Right Inferior Frontal Gyrus (pars triangularis)"},R_Temporal_Pole_7:{path:"right-temporal-pole",wiki_path:"frontal_gyrus",full_name:"Right Temporal Pole"},R_Precentral_Gyrus_6:{path:"right-precentral-gyrus",wiki_path:"frontal_gyrus",full_name:"Right Precentral Gyrus"},R_Middle_Temporal_Gyrus__anterior_division_8:{path:"right-middle-temporal-gyrus-(anterior-division)",wiki_path:"frontal_gyrus",full_name:"Right Middle Temporal Gyrus (anterior division)"},R_Superior_Temporal_Gyrus__posterior_division_9:{path:"right-superior-temporal-gyrus-(posterior-division)",wiki_path:"frontal_gyrus",full_name:"Right Superior Temporal Gyrus (posterior division)"},R_Middle_Temporal_Gyrus__anterior_division_10:{path:"right-middle-temporal-gyrus-(anterior-division)",wiki_path:"precentral_gyrus",full_name:"Right Middle Temporal Gyrus (anterior division)"},R_Middle_Temporal_Gyrus__posterior_division_11:{path:"right-middle-temporal-gyrus-(posterior-division)",wiki_path:"cerebral_hemisphere",full_name:"Right Middle Temporal Gyrus (posterior division)"},R_Middle_Temporal_Gyrus__temporooccipital_part_12:{path:"right-middle-temporal-gyrus-(temporooccipital-part)",wiki_path:"cerebral_hemisphere",full_name:"Right Middle Temporal Gyrus (temporooccipital part)"},R_Inferior_Temporal_Gyrus__posterior_division_13:{path:"right-inferior-temporal-gyrus-(posterior-division)",wiki_path:"middle_temporal_gyrus",full_name:"Right Inferior Temporal Gyrus (posterior division)"},R_Inferior_Temporal_Gyrus__temporooccipital_part_14:{path:"right-inferior-temporal-gyrus-(temporooccipital-part)",wiki_path:"middle_temporal_gyrus",full_name:"Right Inferior Temporal Gyrus (temporooccipital part)"},R_Postcentral_Gyrus_15:{path:"right-postcentral-gyrus",wiki_path:"superior_temporal_gyrus",full_name:"Right Postcentral Gyrus"},R_Superior_Parietal_Lobule_16:{path:"right-superior-parietal-lobule",wiki_path:"superior_temporal_gyrus",full_name:"Right Superior Parietal Lobule"},R_Supramarginal_Gyrus__anterior_division_17:{path:"right-supramarginal-gyrus-(anterior-division)",wiki_path:"inferior_temporal_gyrus",full_name:"Right Supramarginal Gyrus (anterior division)"},R_Supramarginal_Gyrus__posterior_division_18:{path:"right-supramarginal-gyrus-(posterior-division)",wiki_path:"middle_temporal_gyrus",full_name:"Right Supramarginal Gyrus (posterior division)"},R_Angular_Gyrus_19:{path:"right-angular-gyrus",wiki_path:"middle_temporal_gyrus",full_name:"Right Angular Gyrus"},R_Lateral_Occipital_Cortex__superior_division_20:{path:"right-lateral-occipital-cortex-(superior-division)",wiki_path:"middle_temporal_gyrus",full_name:"Right Lateral Occipital Cortex (superior division)"},R_Lateral_Occipital_Cortex__inferior_division_21:{path:"right-lateral-occipital-cortex-(inferior-division)",wiki_path:"middle_temporal_gyrus",full_name:"Right Lateral Occipital Cortex (inferior division)"},R_Intracalcarine_Cortex_22:{path:"right-intracalcarine-cortex",wiki_path:"middle_temporal_gyrus",full_name:"Right Intracalcarine Cortex"},R_Frontal_Medial_Cortex_23:{path:"right-frontal-medial-cortex",wiki_path:"fusiform_gyrus",full_name:"Right Frontal Medial Cortex"},R_Juxtapositional_Lobule_Cortex__formerly_Supplementary_Motor_Cortex__24:{path:"right-juxtapositional-lobule-cortex-(formerly-supplementary-motor-cortex)",wiki_path:"inferior_temporal_gyrus",full_name:"Right Juxtapositional Lobule Cortex (formerly Supplementary Motor Cortex)"},R_Paracingulate_Gyrus_26:{path:"right-paracingulate-gyrus",wiki_path:"inferior_temporal_gyrus",full_name:"Right Paracingulate Gyrus"},R_Subcallosal_Cortex_25:{path:"right-subcallosal-cortex",wiki_path:"inferior_temporal_gyrus",full_name:"Right Subcallosal Cortex"},R_Cingulate_Gyrus__anterior_division_27:{path:"right-cingulate-gyrus-(anterior-division)",wiki_path:"inferior_temporal_gyrus",full_name:"Right Cingulate Gyrus (anterior division)"},R_Cingulate_Gyrus__posterior_division_28:{path:"right-cingulate-gyrus-(posterior-division)",wiki_path:"postcentral_gyrus",full_name:"Right Cingulate Gyrus (posterior division)"},R_Precuneous_Cortex_29:{path:"right-precuneous-cortex",wiki_path:"superior_parietal_lobule",full_name:"Right Precuneous Cortex"},R_Cuneal_Cortex_30:{path:"right-cuneal-cortex",wiki_path:"superior_parietal_lobule",full_name:"Right Cuneal Cortex"},R_Frontal_Orbital_Cortex_31:{path:"right-frontal-orbital-cortex",wiki_path:"supramarginal_gyrus",full_name:"Right Frontal Orbital Cortex"},R_Parahippocampal_Gyrus__anterior_division_32:{path:"right-parahippocampal-gyrus-(anterior-division)",wiki_path:"supramarginal_gyrus",full_name:"Right Parahippocampal Gyrus (anterior division)"},R_Parahippocampal_Gyrus__posterior_division_33:{path:"right-parahippocampal-gyrus-(posterior-division)",wiki_path:"supramarginal_gyrus",full_name:"Right Parahippocampal Gyrus (posterior division)"},R_Lingual_Gyrus_34:{path:"right-lingual-gyrus",wiki_path:"supramarginal_gyrus",full_name:"Right Lingual Gyrus"},R_Angular_Gyrus_35:{path:"right-angular-gyrus",wiki_path:"angular_gyrus",full_name:"Right Angular Gyrus"},R_Temporal_Fusiform_Cortex__posterior_division_36:{path:"right-temporal-fusiform-cortex-(posterior-division)",wiki_path:"angular_gyrus",full_name:"Right Temporal Fusiform Cortex (posterior division)"},R_Temporal_Occipital_Fusiform_Cortex_37:{path:"right-temporal-occipital-fusiform-cortex",wiki_path:"visual_cortex",full_name:"Right Temporal Occipital Fusiform Cortex"},R_Occipital_Fusiform_Gyrus_38:{path:"right-occipital-fusiform-gyrus",wiki_path:"visual_cortex",full_name:"Right Occipital Fusiform Gyrus"},R_Frontal_Operculum_Cortex_39:{path:"right-frontal-operculum-cortex",wiki_path:"visual_cortex",full_name:"Right Frontal Operculum Cortex"},R_Central_Opercular_Cortex_40:{path:"right-central-opercular-cortex",wiki_path:"visual_cortex",full_name:"Right Central Opercular Cortex"},R_Parietal_Operculum_Cortex_41:{path:"right-parietal-operculum-cortex",wiki_path:"lingual_gyrus",full_name:"Right Parietal Operculum Cortex"},R_Planum_Polare_42:{path:"right-planum-polare",wiki_path:"prefrontal_cortex",full_name:"Right Planum Polare"},R_Heschl_s_Gyrus__includes_H1_and_H2__43:{path:"right-heschl's-gyrus-(includes-h-and-h)",wiki_path:"superior_frontal_gyrus",full_name:"Right Heschl's Gyrus (includes H and H)"},R_Planum_Temporale_44:{path:"right-planum-temporale",wiki_path:"brodmann_area_25",full_name:"Right Planum Temporale"},R_Supracalcarine_Cortex_45:{path:"right-supracalcarine-cortex",wiki_path:"cingulate_cortex",full_name:"Right Supracalcarine Cortex"},R_Occipital_Pole_47:{path:"right-occipital-pole",wiki_path:"cingulate_cortex",full_name:"Right Occipital Pole"},R_Superior_Frontal_Gyrus_2:{path:"right-superior-frontal-gyrus",wiki_path:"cingulate_cortex",full_name:"Right Superior Frontal Gyrus"},L_Middle_Temporal_Gyrus__anterior_division_10:{path:"left-middle-temporal-gyrus-(anterior-division)",wiki_path:"cuneus",full_name:"Left Middle Temporal Gyrus (anterior division)"},L_Temporal_Occipital_Fusiform_Cortex_38:{path:"left-temporal-occipital-fusiform-cortex",wiki_path:"cuneus",full_name:"Left Temporal Occipital Fusiform Cortex"},L_Supramarginal_Gyrus__anterior_division_18:{path:"left-supramarginal-gyrus-(anterior-division)",wiki_path:"frontal_lobe",full_name:"Left Supramarginal Gyrus (anterior division)"},L_Insular_Cortex_1:{path:"left-insular-cortex",wiki_path:"frontal_lobe",full_name:"Left Insular Cortex"},L_Juxtapositional_Lobule_Cortex__formerly_Supplementary_Motor_Cortex__25:{path:"left-juxtapositional-lobule-cortex-(formerly-supplementary-motor-cortex)",wiki_path:"parahippocampal_gyrus",full_name:"Left Juxtapositional Lobule Cortex (formerly Supplementary Motor Cortex)"},L_Inferior_Frontal_Gyrus__pars_opercularis_5:{path:"left-inferior-frontal-gyrus-(pars-opercularis)",wiki_path:"parahippocampal_gyrus",full_name:"Left Inferior Frontal Gyrus (pars opercularis)"},L_Frontal_Orbital_Cortex_32:{path:"left-frontal-orbital-cortex",wiki_path:"parahippocampal_gyrus",full_name:"Left Frontal Orbital Cortex"},L_Middle_Temporal_Gyrus__posterior_division_11:{path:"left-middle-temporal-gyrus-(posterior-division)",wiki_path:"parahippocampal_gyrus",full_name:"Left Middle Temporal Gyrus (posterior division)"},L_Occipital_Fusiform_Gyrus_39:{path:"left-occipital-fusiform-gyrus",wiki_path:"lingual_gyrus",full_name:"Left Occipital Fusiform Gyrus"},L_Supramarginal_Gyrus__posterior_division_19:{path:"left-supramarginal-gyrus-(posterior-division)",wiki_path:"fusiform_gyrus",full_name:"Left Supramarginal Gyrus (posterior division)"},L_Supracalcarine_Cortex_46:{path:"left-supracalcarine-cortex",wiki_path:"fusiform_gyrus",full_name:"Left Supracalcarine Cortex"},L_Paracingulate_Gyrus_27:{path:"left-paracingulate-gyrus",wiki_path:"fusiform_gyrus",full_name:"Left Paracingulate Gyrus"},L_Inferior_Frontal_Gyrus__pars_triangularis_4:{path:"left-inferior-frontal-gyrus-(pars-triangularis)",wiki_path:"fusiform_gyrus",full_name:"Left Inferior Frontal Gyrus (pars triangularis)"},L_Parahippocampal_Gyrus__anterior_division_33:{path:"left-parahippocampal-gyrus-(anterior-division)",wiki_path:"fusiform_gyrus",full_name:"Left Parahippocampal Gyrus (anterior division)"},L_Middle_Temporal_Gyrus__temporooccipital_part_12:{path:"left-middle-temporal-gyrus-(temporooccipital-part)",wiki_path:"fusiform_gyrus",full_name:"Left Middle Temporal Gyrus (temporooccipital part)"},L_Frontal_Operculum_Cortex_40:{path:"left-frontal-operculum-cortex",wiki_path:"fusiform_gyrus",full_name:"Left Frontal Operculum Cortex"},L_Angular_Gyrus_20:{path:"left-angular-gyrus",wiki_path:"fusiform_gyrus",full_name:"Left Angular Gyrus"},L_Subcallosal_Cortex_26:{path:"left-subcallosal-cortex",wiki_path:"operculum_(brain)",full_name:"Left Subcallosal Cortex"},L_Planum_Temporale_45:{path:"left-planum-temporale",wiki_path:"operculum_(brain)",full_name:"Left Planum Temporale"},L_Parahippocampal_Gyrus__posterior_division_34:{path:"left-parahippocampal-gyrus-(posterior-division)",wiki_path:"operculum_(brain)",full_name:"Left Parahippocampal Gyrus (posterior division)"},L_Inferior_Temporal_Gyrus__posterior_division_13:{path:"left-inferior-temporal-gyrus-(posterior-division)",wiki_path:"operculum_(brain)",full_name:"Left Inferior Temporal Gyrus (posterior division)"},L_Central_Opercular_Cortex_41:{path:"left-central-opercular-cortex",wiki_path:"operculum_(brain)",full_name:"Left Central Opercular Cortex"},L_Lateral_Occipital_Cortex__superior_division_21:{path:"left-lateral-occipital-cortex-(superior-division)",wiki_path:"operculum_(brain)",full_name:"Left Lateral Occipital Cortex (superior division)"},L_Lingual_Gyrus_35:{path:"left-lingual-gyrus",wiki_path:"auditory_cortex",full_name:"Left Lingual Gyrus"},L_Heschl_s_Gyrus__includes_H1_and_H2__44:{path:"left-heschl's-gyrus-(includes-h-and-h)",wiki_path:"transverse_temporal_gyrus",full_name:"Left Heschl's Gyrus (includes H and H)"},L_Cingulate_Gyrus__anterior_division_28:{path:"left-cingulate-gyrus-(anterior-division)",wiki_path:"transverse_temporal_gyrus",full_name:"Left Cingulate Gyrus (anterior division)"},L_Precentral_Gyrus_6:{path:"left-precentral-gyrus",wiki_path:"auditory_cortex",full_name:"Left Precentral Gyrus"},L_Temporal_Pole_7:{path:"left-temporal-pole",wiki_path:"transverse_temporal_gyrus",full_name:"Left Temporal Pole"},L_Inferior_Temporal_Gyrus__temporooccipital_part_14:{path:"left-inferior-temporal-gyrus-(temporooccipital-part)",wiki_path:"calcarine_sulcus",full_name:"Left Inferior Temporal Gyrus (temporooccipital part)"},L_Superior_Frontal_Gyrus_2:{path:"left-superior-frontal-gyrus",wiki_path:"insular_cortex",full_name:"Left Superior Frontal Gyrus"},L_Lateral_Occipital_Cortex__inferior_division_22:{path:"left-lateral-occipital-cortex-(inferior-division)",wiki_path:"transverse_temporal_gyrus",full_name:"Left Lateral Occipital Cortex (inferior division)"},L_Cingulate_Gyrus__posterior_division_29:{path:"left-cingulate-gyrus-(posterior-division)",wiki_path:"cerebral_hemisphere",full_name:"Left Cingulate Gyrus (posterior division)"},L_Middle_Temporal_Gyrus__anterior_division_8:{path:"left-middle-temporal-gyrus-(anterior-division)",wiki_path:"calcarine_sulcus",full_name:"Left Middle Temporal Gyrus (anterior division)"},L_Angular_Gyrus_36:{path:"left-angular-gyrus",wiki_path:"fusiform_gyrus",full_name:"Left Angular Gyrus"},L_Parietal_Operculum_Cortex_42:{path:"left-parietal-operculum-cortex",wiki_path:"operculum_(brain)",full_name:"Left Parietal Operculum Cortex"},L_Postcentral_Gyrus_16:{path:"left-postcentral-gyrus",wiki_path:"superior_temporal_gyrus",full_name:"Left Postcentral Gyrus"},L_Planum_Polare_43:{path:"left-planum-polare",wiki_path:"superior_temporal_gyrus",full_name:"Left Planum Polare"},L_Intracalcarine_Cortex_23:{path:"left-intracalcarine-cortex",wiki_path:"middle_temporal_gyrus",full_name:"Left Intracalcarine Cortex"},L_Precuneous_Cortex_30:{path:"left-precuneous-cortex",wiki_path:"superior_parietal_lobule",full_name:"Left Precuneous Cortex"},L_Superior_Temporal_Gyrus__posterior_division_9:{path:"left-superior-temporal-gyrus-(posterior-division)",wiki_path:"calcarine_sulcus",full_name:"Left Superior Temporal Gyrus (posterior division)"},L_Temporal_Fusiform_Cortex__posterior_division_37:{path:"left-temporal-fusiform-cortex-(posterior-division)",wiki_path:"angular_gyrus",full_name:"Left Temporal Fusiform Cortex (posterior division)"},L_Superior_Parietal_Lobule_17:{path:"left-superior-parietal-lobule",wiki_path:"superior_temporal_gyrus",full_name:"Left Superior Parietal Lobule"},L_Frontal_Pole_0:{path:"left-frontal-pole",wiki_path:"frontal_gyrus",full_name:"Left Frontal Pole"},L_Frontal_Medial_Cortex_24:{path:"left-frontal-medial-cortex",wiki_path:"frontal_gyrus",full_name:"Left Frontal Medial Cortex"},L_Middle_Frontal_Gyrus_3:{path:"left-middle-frontal-gyrus",wiki_path:"frontal_gyrus",full_name:"Left Middle Frontal Gyrus"},L_Cuneal_Cortex_31:{path:"left-cuneal-cortex",wiki_path:"superior_parietal_lobule",full_name:"Left Cuneal Cortex"},L_Occipital_Pole_48:{path:"left-occipital-pole",wiki_path:"cingulate_cortex",full_name:"Left Occipital Pole"}};var html=document.querySelector("html"),brain_wrapper=document.querySelector(".brain-wrapper");function init(){!0===WEBGL.isWebGLAvailable()?route():warning("Your web browser or graphics card doesn't support WebGL. Try another device or browser."),detectTabbing()}function route(){var e=window.location.pathname;initBrain(),initSettings(),"/"!==e&&Object.keys(regions_obj).forEach(function(r){"/"+regions_obj[r].path==e&&(console.log("switchRegion("+r+")"),switchRegion(r))})}function initBrain(){updateStatus("Loading model"),getSizes(),loadRegions(),camera=new THREE.PerspectiveCamera(50,brain_wrapper.offsetWidth/brain_wrapper.offsetHeight,.1,1e3),camera.position.set(0,5,25),controls=new THREE.OrbitControls(camera,brain_wrapper),controls.enableZoom=settings.zoom.enabled,settings.zoom.max=controls.target.distanceTo(controls.object.position),controls.maxDistance=settings.zoom.max,controls.minDistance=settings.zoom.min,controls.enablePan=settings.pan,controls.autoRotate=settings.orbit,controls.autoRotateSpeed=settings.orbit_speed,controls.addEventListener("start",function(){controls.autoRotate=!1,document.querySelector(".orbit-toggle input").checked=!1}),controls.target.set(0,0,0),controls.update(),scene=new THREE.Scene,ray_objects=[];var e=new THREE.LoadingManager;e.onStart=function(e,r,t){updateStatus("Receiving data ("+r+"/"+t+")")},e.onLoad=function(){updateStatus("Rendering brain")},e.onProgress=function(e,r,t){if(r>t)r=t;updateStatus("Loading brain ("+r+"/"+t+")")},e.onError=function(e){updateStatus("Error loading brain")},new THREE.GLTFLoader(e).load("models/"+settings.brain_model_path,function(e){i=0,e.scene.traverse(function(e){console.log("meshs"),e.isMesh&&(console.log(e),i++,e.material.roughness=settings.brain.roughness,e.material.metalness=settings.brain.metalness,e.material.wireframe=settings.brain.wireframe,e.material.color.setStyle(settings.brain.color.default),e.material.side=THREE.DoubleSide,console.log(e.name),regions_obj[e.name].mesh=e,ray_objects.push(e),i==Object.keys(regions_obj).length&&(setupRegionsFilter(),animate()))}),e.scene.position.set(settings.brain.offset.x,settings.brain.offset.y,settings.brain.offset.z),scene.add(e.scene)},function(e){},function(e){console.log(e)});var r=new THREE.HemisphereLight(16751001,.8);scene.add(r);var t=new THREE.DirectionalLight(11517951,.5);t.position.set(0,10,0),scene.add(t),raycaster=new THREE.Raycaster,raycaster_paused=!1,last_intersected=null,mouse=new THREE.Vector2(1e3,1e3,1e3),renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0,side:THREE.DoubleSide}),renderer.setPixelRatio(window.devicePixelRatio),renderer.gammaOutput=!0,setCanvasSize(),brain_wrapper.appendChild(renderer.domElement),window.addEventListener("resize",setCanvasSize,!1);var a=document.querySelector(".brain-wrapper canvas");a.addEventListener("mousemove",onCanvasMove,!1),a.addEventListener("mousedown",onCanvasDown,!1),a.addEventListener("mouseup",onCanvasUp,!1),a.addEventListener("touchmove",onCanvasMove,!1),a.addEventListener("touchstart",onCanvasDown,!1),a.addEventListener("touchend",onCanvasUp,!1),document.querySelector(".back-button").addEventListener("click",function(){reset(),raycaster_paused=!1})}function getSizes(){sizes=document.querySelector(".brain-wrapper").getBoundingClientRect()}function setCanvasSize(){getSizes(),camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height)}function getCanvasMousePosition(e){if(console.log(e),e.touches){if(e.touches.length>0)var r=e.touches[0].pageX,t=e.touches[0].pageY}else r=e.clientX,t=e.clientY;mouse.x=(r-sizes.left)/sizes.width*2-1,mouse.y=-(t-sizes.top)/sizes.height*2+1}function onCanvasMove(e){e.preventDefault(),getCanvasMousePosition(e)}function onCanvasDown(e){0==raycaster_paused&&0==settings.slice.visible&&(console.log("onCanvasDown();"),e.preventDefault(),getCanvasMousePosition(),raycaster.setFromCamera(mouse,camera),last_intersected.material.color.setStyle(settings.brain.color.active),raycaster_paused=!0)}function onCanvasUp(e){console.log("onDocumentMouseUp();"),1==raycaster_paused&&0==settings.slice.visible&&(raycaster_paused=!1,rayCast())}function onDocumentClick(e){}function animate(){requestAnimationFrame(animate),rayCast(),controls.update(),renderer.render(scene,camera)}function rayCast(){if(0==raycaster_paused&&0==settings.slice.visible){raycaster.setFromCamera(mouse,camera);var e=raycaster.intersectObjects(ray_objects);e.length>0?e[0].object!=last_intersected&&(last_intersected&&last_intersected.material.color.setStyle(settings.brain.color.default),last_intersected=e[0].object,last_intersected.material.color.setStyle(settings.brain.color.hover)):(last_intersected&&last_intersected.material.color.setStyle(settings.brain.color.default),last_intersected=null)}}function setupRegionsFilter(){document.querySelector(".regions-filter").onchange=(e=>{console.log("change!"),raycaster_paused=!0,switchRegion(e.target.value)})}function switchRegion(e){var r=regions_obj[e];history.pushState(null,null,"/"+r.path),document.querySelector("html").classList.add("has-region-content","has-content"),renderer.render(scene,camera),i=0,document.querySelector(".content-wrapper .container").innerHTML="",scene.traverse(function(r){r.isMesh&&(r.material.transparent=!1,r.material.opacity=1,r.name!==e&&"Head"!==r.name&&(r.material.transparent=!0,r.material.opacity=.1))}),document.querySelector("html").classList.add("is-loaded");var t="https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&explaintext=true&exintro=true&redirects=true&titles="+r.wiki_path+"&callback=?";document.querySelector(".content-wrapper .container").innerHTML+="<h2>"+r.full_name+"</h2>",JSONP({url:t,success:function(e){r.wiki_path,e.query.normalized[0].to;var t=Object.keys(e.query.pages)[0];e.query.pages[t].extract;document.querySelector(".content-wrapper .container").innerHTML+="<p>Unable to retrieve Wikipedia article summary.</p>"},error:function(e){document.querySelector(".content-wrapper .container").innerHTML+="<p>Unable to retrieve Wikipedia article summary.</p>"}}),scrollTop()}function initSettings(){sliceToggle(),orbitToggle(),headToggle(),axesToggle()}function orbitToggle(){var e=document.querySelector(".orbit-toggle input");e.checked=settings.orbit,e.addEventListener("change",function(){e.checked?(settings.orbit=!0,controls.autoRotate=!0):(settings.orbit=!1,controls.autoRotate=!1),saveSettings()})}function sliceToggle(){var e=document.querySelector(".slice-toggle input");e.addEventListener("change",function(){e.checked?setupSliceTool():hideSliceTool(),scrollTop()})}function setupSliceTool(){settings.slice.visible=!0,document.querySelector('input[name="slice_axis"][value="'+settings.slice.axis+'"]').checked=!0,document.querySelector(".slice-tool").classList.remove("is-hidden");var e=document.querySelector(".spinner");null!==e&&e.parentNode.removeChild(e),document.querySelector(".regions-filter").value="",slice(),sliceCameraCentering(),document.querySelectorAll('[name="slice_axis"]').forEach(function(e){e.addEventListener("change",function(){settings.slice.axis=document.querySelector('[name="slice_axis"]:checked').value,saveSettings(),sliceCameraCentering(),slice()})}),document.querySelector(".slice-range").addEventListener("input",function(){controls.autoRotate=!1,settings.slice.position=this.value,saveSettings(),slice()})}function hideSliceTool(){settings.slice.visible=!1,document.querySelector(".slice-tool").classList.add("is-hidden"),renderer.localClippingEnabled=!1,renderer.clippingPlanes=[],document.querySelector(".slice-toggle input").checked=!1}function sliceCameraCentering(){"y"==settings.slice.axis&&camera.position.set(50,0,0),"x"==settings.slice.axis&&camera.position.set(0,0,50),"z"==settings.slice.axis&&camera.position.set(0,50,0)}function slice(){if(controls.autoRotate=!1,"y"==settings.slice.axis)var e=[1,0,0];if("x"==settings.slice.axis)e=[0,0,1];if("z"==settings.slice.axis)e=[0,1,0];var r=settings.slice.dimensions[settings.slice.axis]*settings.slice.position,t=[new THREE.Plane(new THREE.Vector3(e[0],e[1],e[2]),-1*r+settings.slice.size/2),new THREE.Plane(new THREE.Vector3(-e[0],-e[1],-e[2]),r+settings.slice.size/2)];renderer.localClippingEnabled=!0,renderer.clippingPlanes=t}function squareGridToggle(){var e=document.querySelector(".square-grid-toggle input"),r=new THREE.GridHelper(2*settings.grid_size,settings.grid_size/2);e.checked=settings.square_grid,1==settings.square_grid?scene.add(r):scene.remove(r),e.addEventListener("change",function(){e.checked?(settings.square_grid=!0,scene.add(r)):(settings.square_grid=!1,scene.remove(r)),saveSettings()})}function polarGridToggle(){var e=document.querySelector(".polar-grid-toggle input"),r=new THREE.PolarGridHelper(settings.grid_size,8,5,64,7829367,7829367);e.checked=settings.polar_grid,1==settings.polar_grid?scene.add(r):scene.remove(r),e.addEventListener("change",function(){e.checked?(settings.polar_grid=!0,scene.add(r)):(settings.polar_grid=!1,scene.remove(r)),saveSettings()})}function axesToggle(){var e=document.querySelector(".axes-toggle input"),r=new THREE.AxesHelper(settings.grid_size);e.checked=settings.axes,1==settings.axes?scene.add(r):scene.remove(r),e.addEventListener("change",function(){e.checked?(settings.axes=!0,scene.add(r)):(settings.axes=!1,scene.remove(r)),saveSettings()})}function headToggle(){head_mesh=void 0;var e=document.querySelector(".head-toggle input");1==settings.head.visible&&(loadHead(),e.checked=!0),e.addEventListener("change",function(){e.checked?null==head_mesh?loadHead():head_mesh.visible=!0:head_mesh.visible=!1,saveSettings()})}function loadHead(){var e=new THREE.LoadingManager;e.onStart=function(e,r,t){updateStatus("Loading head ("+r+"/"+t+")")},e.onLoad=function(){updateStatus("Rendering head")},e.onProgress=function(e,r,t){updateStatus("Loading head ("+r+"/"+t+")")},e.onError=function(e){updateStatus("Error loading head")},new THREE.GLTFLoader(e).load("models/"+settings.head_model_path,function(e){updateStatus("Rendering Head"),e.scene.traverse(function(e){e.isMesh&&(e.material.roughness=settings.head.roughness,e.material.metalness=settings.head.metalness,e.material.wireframe=settings.head.wireframe,e.material.color.setStyle(settings.head.color.default),e.visible=!0,settings.head.opacity<1&&(e.material.transparent=!0,e.material.opacity=settings.head.opacity),head_mesh=e)}),e.scene.position.set(settings.head.offset.x,settings.head.offset.y,settings.head.offset.z),scene.add(e.scene),console.log(scene.children)},function(e){},function(e){console.log(e)})}function reset(){console.log("reset();"),history.pushState(null,null,"/"),controls.target.set(0,0,0),controls.update(),i=0,scene.traverse(function(e){e.isMesh&&(e.material.transparent=!1,e.material.opacity=1,"Head"==e.name&&settings.head.opacity<1&&(e.material.transparent=!0,e.material.opacity=settings.head.opacity,e.material.color.setStyle(settings.head.color.default)))}),document.querySelector("html").classList.remove("has-region-content","has-content"),document.querySelector(".regions-wrapper").classList.remove("is-inactive"),document.querySelector(".settings-wrapper").classList.remove("is-inactive"),document.querySelector(".content-wrapper .container").innerHTML="",document.querySelector(".regions-filter").value="",1==settings.orbit&&(document.querySelector(".orbit-toggle input").checked=!0,controls.autoRotate=!0),scrollTop()}function updateStatus(e){var r='<div class="status container">'+e+"...</div>";document.querySelector(".status-wrapper").innerHTML=r}function warning(e){var r='<p class="container">'+e+"</p>";document.querySelector(".warning").innerHTML=r;var t=document.querySelector(".spinner");null!==t&&t.parentNode.removeChild(t)}function detectTabbing(){window.addEventListener("keydown",function e(r){9===r.keyCode&&(document.querySelector("html").classList.add("is-tabbing"),window.removeEventListener("keydown",e))})}function loadSettings(){localStorage.getItem("hbr_settings")&&(settings=JSON.parse(localStorage.getItem("hbr_settings")))}function saveSettings(){localStorage.setItem("hbr_settings",JSON.stringify(settings))}function scrollTop(){window.scroll(0,0)}init();